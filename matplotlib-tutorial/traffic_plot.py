import numpy as np
import matplotlib.pyplot as plt
import matplotlib.ticker as mticker


def plot_learning_curve(x, costs, score, filename=None):
    fig = plt.figure(figsize=(10, 5))

    ax = fig.add_subplot(111, label='1')
    ax2 = fig.add_subplot(111, label='2', frame_on=False)

    ax2.plot(x, score, color='g')
    ax2.set_xlabel(f'Training episodes | Total steps: {steps}')  # | Time: {time} min.', color='C0')
    ax2.set_ylabel('Score', color='g')
    ax2.tick_params(axis='x', colors='black')
    ax2.tick_params(axis='y', colors='g')

    costs = -costs
    N = len(costs)
    running_avg = np.empty(N)
    for t in range(N):
        running_avg[t] = np.mean(costs[max(0, t - 100):(t + 1)])

    ax.scatter(x, running_avg, color='C1', s=6)

    ax.axes.get_xaxis().set_visible(False)
    ax.xaxis.set_major_locator(mticker.MaxNLocator(integer=True))

    ax.yaxis.tick_right()
    ax.set_ylabel('current_cost', color='C1')
    ax.yaxis.set_label_position('right')
    ax.tick_params(axis='y', colors='C1')

    # if filename:
    #     plt.savefig(filename)

    plt.grid(True, which='both', axis='both', color='grey', linestyle='--', linewidth=0.4)
    ax.grid(True, which='both', axis='x', color='grey', linestyle='--', linewidth=0.4)

    plt.show()


costs = np.array([3935, 2733, 5724, 8840, 1003, 15859, 2415, 3825, 4243, 2728, 2394, 5100, 4039, 28677, 5026, 20885, 7623, 1427, 1713, 2995, 4335, 13817, 16108, 4814, 4027, 8297, 5824, 5942, 8456, 3345, 3220, 6520, 3121, 1439, 23920, 1851, 9828, 7023, 12647, 1107, 1201, 3674, 2153, 20612, 2271, 2597, 7971, 1237, 4328, 3773, 5528, 2267, 15519, 8984, 11579, 7615, 1820, 3076, 6038, 3959, 8274, 3346, 24783, 2277, 6524, 2066, 12808, 5510, 11840, 1473, 3065, 6480, 1982, 1046, 1847, 6884, 1070, 1763, 2259, 19333, 3216, 1797, 10240, 2083, 1196, 6387, 3415, 6167, 2323, 2453, 4109, 1006, 2234, 3259, 2979, 3060, 5071, 5101, 3003, 9518, 2190, 5020, 2051, 3198, 1123, 2218, 7295, 2942, 735, 17191, 3334, 2139, 6999, 727, 9305, 5007, 11079, 5118, 16651, 11235, 2979, 6067, 361, 5679, 2238, 16920, 5175, 1540, 3358, 3370, 3203, 1845, 2198, 2320, 7476, 1211, 7510, 1332, 15918, 1549, 9269, 3111, 4243, 3289, 6328, 4864, 2244, 1559, 2696, 5366, 8463, 6896, 4404, 1892, 2857, 5644, 981, 11910, 2538, 4425, 3641, 1307, 3422, 3210, 2050, 5095, 6024, 2936, 1327, 6478, 2560, 4782, 2426, 895, 3800, 17444, 2756, 5435, 2575, 2949, 7549, 5, 1711, 3382, 4424, 8964, 5508, 3411, 3389, 1793, 5081, 7711, 7603, 3306, 4574, 751, 2631, 1023, 1535, 2859, 4759, 2830, 12978, 2688, 1958, 6319, 5011, 3341, 4498, 15406, 2690, 2963, 24760, 3167, 1177, 3584, 1097, 1675, 14305, 3728, 28176, 2828, 7640, 10402, 1903, 835, 13293, 2194, 6655, 1718, 4551, 1646, 1106, 5022, 1230, 1287, 5606, 1529, 6493, 1655, 1251, 791, 4515, 2903, 452, 6881, 1419, 7208, 3520, 1383, 3855, 2273, 705, 2673, 2120, 1946, 301, 4060, 1775, 1812, 3611, 21071, 4201, 22870, 1858, 4695, 1500, 5757, 2941, 1514, 1437, 2117, 712, 1401, 341, 3777, 15564, 1479, 4977, 1012, 7879, 974, 1349, 5687, 3396, 785, 1357, 2288, 3674, 2795, 2457])
score = np.array([2826, 8248, -1542, -4349, 6654, -15977, 5403, 5313, 2742, 4761, 5497, 1452, 3056, -35088, 1546, -20079, -2730, 7034, 9609, 4421, 2936, -10439, -16059, 1760, 1901, -910, 7, -1451, -4710, 6760, 4076, -1080, 7200, 5991, -29812, 6394, -5940, -1257, -11824, 7406, 10363, 3204, 8928, -22962, 5902, 6878, -4665, 10295, 2512, 6365, 869, 5490, -17156, -4618, -10043, -4786, 5414, 4024, -482, 3082, -4202, 4116, -31682, 8694, -925, 5958, -11542, 56, -9812, 9976, 6127, -751, 6061, 7609, 6459, -1086, 7622, 6398, 4533, -20068, 4311, 8387, -7249, 5837, 7497, -3129, 2748, -74, 5477, 8072, 5575, 6669, 5798, 4190, 3416, 3176, 576, 1908, 4296, -7742, 5480, -44, 6036, 4128, 6473, 4915, -1710, 3284, 8082, -18516, 4272, 5839, -4604, 7004, -2040, 998, -7952, 842, -17266, -8626, 4503, -1004, -98627, -768, 5737, -18480, 1403, 5876, 3004, 3634, 4108, 9490, 5735, 5592, -3110, 6178, -3102, 6012, -16456, 8746, -105600, 4498, 2830, 7448, -1060, 662, 5665, 5837, 4742, -326, -4270, -1695, 2287, 6363, 8136, 40, 10780, -9234, 5378, 5184, 6320, 6198, 3834, 4210, 5930, 1636, -1196, 4362, 7064, -1636, 5334, 1223, 5484, 6767, 3572, -17799, 4855, 178, 4075, 7468, -104262, -100005, 6482, 3693, 1960, -4660, 123, 2808, 6832, 8275, 4254, -2842, -2546, 3732, 2074, 8078, 4912, 7593, 6574, 4830, 1446, 4381, -12810, 4096, 5830, -1058, 778, 6776, 846, -15706, 4442, 4572, -31842, 4339, 10511, 3372, 9486, 6375, -115770, 3354, -36078, 4762, -2901, -8064, 4911, 7871, -112964, 5722, -1428, 6596, 2226, 5455, 7474, 958, 6252, 7132, -536, -95544, 988, 6408, 6135, 7837, 2172, 4466, 8504, 870, 6934, -2228, 2568, 7018, 2782, 8680, -94042, 7414, 4882, 5092, 11658, 2352, 6323, 6226, 3239, -25512, -98565, -29261, 6581, 1816, 5810, 3473, -97270, 6798, -96120, 8940, 7969, -96238, -99690, -99568, -16704, 6718, -99384, 7582, -3912, 7684, -95037, -28, 3734, 11054, -94019, 5446, 3346, 4965, -95766])
x = np.arange(len(costs))
steps = '1 335 277'
print(x)


plot_learning_curve(x, costs, score, steps)

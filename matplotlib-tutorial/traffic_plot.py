import numpy as np
import matplotlib.pyplot as plt
import matplotlib.ticker as mticker


def plot_learning_curve(x, costs, score, filename=None):
    fig = plt.figure(figsize=(10, 5))

    ax = fig.add_subplot(111, label='1')
    ax2 = fig.add_subplot(111, label='2', frame_on=False)

    ax2.plot(x, score, color='g')
    ax2.set_xlabel(f'Training episodes | Total steps: {steps}')  # | Time: {time} min.', color='C0')
    ax2.set_ylabel('Score', color='g')
    ax2.tick_params(axis='x', colors='black')
    ax2.tick_params(axis='y', colors='g')

    costs = -costs
    N = len(costs)
    running_avg = np.empty(N)
    for t in range(N):
        running_avg[t] = np.mean(costs[max(0, t - 100):(t + 1)])

    ax.scatter(x, running_avg, color='C1', s=6)

    ax.axes.get_xaxis().set_visible(False)
    ax.xaxis.set_major_locator(mticker.MaxNLocator(integer=True))

    ax.yaxis.tick_right()
    ax.set_ylabel('current_cost', color='C1')
    ax.yaxis.set_label_position('right')
    ax.tick_params(axis='y', colors='C1')

    # if filename:
    #     plt.savefig(filename)

    plt.grid(True, which='both', axis='both', color='grey', linestyle='--', linewidth=0.4)
    ax.grid(True, which='both', axis='x', color='grey', linestyle='--', linewidth=0.4)

    plt.show()


costs = np.array([493, 1620, 1193, 1125, 849, 1233, 209, 1869, 5, 981, 1301, 2001, 493, 2341, 5, 1529, 5, 725, 1245, 601, 2400, 2211, 541, 577, 1655, 945, 137, 805, 2169, 1841, 1877, 353, 3733, 1309, 3837, 5, 1684, 1222, 333, 377, 145, 2446, 2661, 1787, 457, 1869, 133, 2357, 153, 1361, 973, 5, 3172, 517, 165, 937, 1949, 1169, 1085, 409, 1033, 1177, 3189, 989, 1817, 2941, 173, 1293, 429, 333, 4675, 557, 937, 133, 493, 973, 5, 157, 333, 5, 973, 1045, 365, 1380, 4859, 777, 177, 2022, 2589, 2053, 549, 5, 1673, 1245, 985, 1009, 5, 2509, 2817, 2833, 1141, 901, 1493, 645, 953, 1957, 825, 2729, 5, 5, 4751, 265, 2841, 1365, 5, 1937, 2625, 2225, 6365, 1097, 5, 5, 1425, 977, 545, 893, 541, 1161, 2605, 2541, 5, 1721, 3181, 833, 401, 1565, 2765, 4117, 745, 5, 5, 5, 2993, 1557, 885, 1097, 7718, 249, 5817, 1909, 689, 5, 145, 185, 1089, 28425, 4233, 5, 5, 5, 6217, 19821])
score = np.array([-94646, 4643, -97926, -94037, -93015, -93442, -97390, -95699, -100001, 10802, -97850, -96242, -96678, -94013, -100012, -94968, -100012, -96088, -95552, -99000, 5613, 6144, -97743, -98959, 7171, -97351, -100328, -96736, -95815, -96152, -96405, -97555, -98309, -99717, -96461, -100012, 7177, 7567, -97489, -96663, -100347, 6589, -95100, 5788, -97654, -95602, -100320, -101067, -100354, -95832, -95100, -99007, 5403, -96668, -100365, -98130, -93191, -94565, -94421, -98742, -98281, 8455, -95055, -95551, -96014, -97193, -100345, -98626, -97806, -99537, 1514, -97906, -95239, -100214, -98708, -100381, -100012, -98176, -99532, -100001, -96397, -94344, -98693, 6160, 3517, -99004, -99368, 6792, -94278, -99345, -99778, -100012, 8778, -95485, -94138, -96581, -100012, -96967, -96538, -94086, -100581, -99236, -93771, -99995, -97292, -99177, -97974, -95917, -100012, -100012, 1968, -100503, -95991, -94642, -100012, -96696, -97514, -93688, -99200, -96369, -100001, -100012, -92688, -97212, -96835, -97139, -96801, -94827, -93806, -97704, -100012, -96814, -95182, -95181, -99743, -95752, -95261, -97504, -96809, -100001, -100001, -100012, -95432, -100025, -96993, -95665, -193, -98494, -98604, -97584, -96970, -100012, -99303, -100426, -96307, -130100, -102682, -100012, -100001, -100012, -102741, -121095])
x = np.arange(len(costs))
steps = '246 339'
print(x)


plot_learning_curve(x, costs, score, steps)
